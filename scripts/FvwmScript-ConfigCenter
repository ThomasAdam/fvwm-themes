# This script is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
#

#-----------------------------------------------------------------------------
# Copyright 2000, Olivier Chapuis
#-----------------------------------------------------------------------------


WindowTitle {Fvwm Themes Configuration Center}
WindowSize 610 480
Font	-adobe-helvetica-bold-r-*-*-12-*

Init
Begin
    Do {FvwmScript FvwmScript-NoteMessage "Loading Configuration"}

    Set $Lang = {}
    Set $ViewerColorset = 33
    Set $TextColorset = 34
    Set $IconColorset = 5
    # Arguments
    Set $i = 1
    Set $arg = (GetScriptArgument $i)
    While $arg <> {} Do
    Begin
	Set $j = (Add $i 1)
	If $arg == {--viewer-colorset} Then
	    Set $ViewerColorset = (GetScriptArgument $j)
	If $arg == {--text-colorset} Then
	    Set $TextColorset = (GetScriptArgument $j)
	If $arg == {--icon-colorset} Then
	    Set $IconColorset = (GetScriptArgument $j)
	If $arg == {--lang} Then
	    Set $Lang = (GetScriptArgument $j)	
	Set $i = (Add $i 2)
	Set $arg = (GetScriptArgument $i)
    End

    If $TextColorset <> {} Then
    Begin
	ChangeColorset 35 $TextColorset
	ChangeColorset 46 $TextColorset
	ChangeColorset 51 $TextColorset
	ChangeColorset 53 $TextColorset
	ChangeColorset 58 $TextColorset
	ChangeColorset 68 $TextColorset
	ChangeColorset 71 $TextColorset
	ChangeColorset 78 $TextColorset
	ChangeColorset 81 $TextColorset
	ChangeColorset 98 $TextColorset
	ChangeColorset 102 $TextColorset
	ChangeColorset 104 $TextColorset
    End

    If $ViewerColorset <> {} Then
    Begin
	ChangeColorset 990 $ViewerColorset
    End

# -----------------------------------------------------------------------------
# Initialization of the com loop and first query

    # found the FvwmScript pid
    Set $cmd = {perl -e '$t=getppid; print $t . "\n"'}
    Set $pid = (GetOutput $cmd 1 -1)

    # Run fvwm-themes-script until the end of the script
    Do {Exec fvwm-themes-script --config-center --com-name=script-}$pid{ &}

    # to send fvwm-themes-com command
    Set $SendMsgAndGet = {fvwm-themes-com --name script-}$pid{ --lock-and-get --message=}
    Set $SendMsg = {fvwm-themes-com --name script-}$pid{ --message=}
    Set $GetLine = {fvwm-themes-com --name script-}$pid{ --get-buffer --line=}


    Set $GF_FileName = {globalfeel}
    # component at start
    Set $Component = $GF_FileName

    # --------------------------------- get the "themes configurations"
    ### personal themes
    Set $cmd = $SendMsgAndGet{"get-themes-info" --line=1}
    Set $PersonalThemes = (GetOutput $cmd 1 -1)
    ChangeTitle 959 $PersonalThemes
    ### GF save, current and themes
    Set $cmd = $GetLine{2 --clear-buffer}
    Set $out = (GetOutput $cmd 1 -1)
    Set $index = 1
    Set $tmp = (StrCopy $out $index $index)
    Set $value = {}
    While $tmp <> {!} Do
    Begin
	Set $value = $value $tmp
	Set $index = (Add $index 1)
	Set $tmp = (StrCopy $out $index $index)
	If $index > 3200 Then
	    Set $tmp = {!}
    End
    ChangeTitle 957 $value
    Set $index = (Add $index 1)
    Set $tmp = (StrCopy $out $index $index)
    Set $value = {}
    While $tmp <> {!} Do
    Begin
	Set $value = $value $tmp
	Set $index = (Add $index 1)
	Set $tmp = (StrCopy $out $index $index)
	If $index > 3200 Then
	    Set $tmp = {!}
    End
    Set $GF_CurrentTheme = $value
    Set $index = (Add $index 1)
    Set $tmp = (StrCopy $out $index $index)
    Set $value = {}
    While $tmp <> {!} Do
    Begin
	Set $value = $value $tmp
	Set $index = (Add $index 1)
	Set $tmp = (StrCopy $out $index $index)
	If $index > 3200 Then
	    Set $tmp = {!}
    End
    Set $GF_ThemesWith = $value
    ChangeTitle 953 $GF_ThemesWith
    If $index > 3200 Then
    Begin
	Do {Echo ConfigCenter: problems when loading themes config!}
	Do {Echo ConfigCenter: can you send a bug report to:}
	Do {Echo ConfigCenter: <fvwm-themes-devel@lists.sourceforge.net>}
	SendSignal 995 1
    End
    # Loading the configuration:
    Set $cmd = $SendMsgAndGet{"get-config current All All" --line=1}
    Set $error = (GetOutput $cmd 1 -1)
    Set $cmd = $GetLine{2 --clear-buffer}
    Set $GF_Config = (GetOutput $cmd 1 -1)

# ----------------------------------------------------------------------------
# Internationalization.

    Set $SelFont = {-adobe-helvetica-bold-r-*-*-12-*}
    Set $ShadeFont = {-adobe-helvetica-medium-r-*-*-12-*}
    Set $nonDefaultFont = 0

    #Set $Lang = {en}
    #Set $Lang = {ru}
    Set $locateSet = 0
    If $Lang == {} Then
    Begin
	Set $cmd = {echo "$LANG" | cut -c1-2}
	Set $Lang = (GetOutput $cmd 1 -1)
    End
    Set $locateSet = 0
    If $Lang == {fr} Then
    Begin
	### Head
	Set $locateSet = 1
	ChangeTitle 1 {Fichier|thèmes Personels|Quitter}
	ChangeTitle 2 {Général|Focus et Placement|Déplacement & Dimension|Pagination & Paramètres Souris|Fenètres Transitoires & Animation|Indications & Paramètres Avancés|Préférences ...}
	ChangeTitle 3 {Racourcis|Clavier|Souris|Applications|Stroke|Préférences ...}
	ChangeTitle 4 {Look|Bouttons|Couleurs|Styles du Menu|Styles des Fenètres|Curseurs|Préférences ...}
	ChangeTitle 5 {Divers|Effets de Sons|Fond d'écran|Démarrage|Préférences ...}
	Set $l_OnlyGlobal = {Seulement Global est implementé}
	### Focus
	# no more that 44 characteres in title from 10 to 17
	ChangeTitle 10 { Règle pour le Focus }
	ChangeTitle 11 {Cliquer pour avoir le focus}
	ChangeTitle 12 {Le focus suit la souris}
	ChangeTitle 13 {Le focus suit la souris sauf sur le fond}
	ChangeTitle 14 { Options pour le Focus }
	ChangeTitle 15 {Passer les cliques qui donnent le focus}
	ChangeTitle 16 {Un clique dans une fenètre la met en avant}
	ChangeTitle 17 {La "ColorMap" suit le Focus}
	### Placement
	ChangeTitle 18 { Placement des Fenètres }
	ChangeTitle 19 { Placement intelligent s'il y de la place, aléatoires si non}
	ChangeTitle 20 { Placement intelligent s'il y de la place, intéractif si non}
	ChangeTitle 21 { On essaie toujours de placer intelligemment les fenètres}
	ChangeTitle 22 { Placement des fenètres toujours interactifs}
	ChangeTitle 23 { Placement des fenètres en "cascade" (jamais interactif)}
	ChangeTitle 24 { Options pour le Placement des Fenètres }
	ChangeTitle 25 { Les nouvelles fenètres prennent le focus }
	ChangeTitle 26 { On respecte les indications de positions données par les nouvelles fenètres}
	### Move & Resize
	ChangeTitle 30 { Déplacement et Redimensionnement }
	# No more than 25 characteres for 31, 32 and 33, be exact for 31
	ChangeTitle 31 {Redimensionnement:      }
	ChangeTitle 32 {Opaque              }
	ChangeTitle 33 {Avec des lignes     }
	# be exact
	ChangeTitle 34 {Déplacement Opaque pour les fenètres prenant moins de      }
	# No more than
	ChangeTitle 36 {% de l'écran}
	# Exactly
	ChangeTitle 37 {Position de la fenètre de géometrie:      }
	ChangeTitle 38 {Centrée                }
	ChangeTitle 39 {En Haut à gauche       }
	ChangeTitle 40 {Cacher la fenètre de géometrie pour:      }
	ChangeTitle 41 {Redimensionnement      }
	ChangeTitle 42 {Déplacement            }
	ChangeTitle 43 {Activer cette option seulment si les fenètres "flash" lors du déplacement}
	# Snap attraction
	ChangeTitle 44 {Attraction des Fenètres lors du Déplacement}
	# 44 and 46 exactly the same size
	ChangeTitle 45 {Distance:     }
	ChangeTitle 47 {Contexte:     }
	ChangeTitle 48 {Icones & Fenètres|Même type|Fenètres|Icones|Icones, Fenètres & écran|Même type & écran|Fenètres & écran|Icones & écran}
	# Slow server
	ChangeTitle 49 {Grille d'attraction:      }
	ChangeTitle 54{Couleur ou Pixmap XOR pour les "lignes" (et Stroke)}
	ChangeTitle 55 {Utiliser une couleur          }
	ChangeTitle 56 {Utiliser un pixmap (xpm)           }
#	ChangeTitle 57 {Une couleur:       }
	Set $l_OneColor =  {Une couleur (pixels):     x}
	Set $l_OnePixmap = {Un Pixmap (xpm):           }
	Set $l_StartColorSel = {Palette}
	Set $l_StartImages = {Images}
	ChangeTitle 59 $l_StartColorSel
	### Pagination
	ChangeTitle 60 { Pagination }
	ChangeTitle 61 {Pagination Horizontale:       }
	ChangeTitle 62 {Non active|100 %|90 %|75 %|66 %|50 %|33 %|25 %|10 %|5%}
	ChangeTitle 63 {Pagination Ciculaire          }
	ChangeTitle 64 {Pagination Verticale:         }
	ChangeTitle 65 {Non active|100 %|90 %|75 %|66 %|50 %|33 %|25 %|10 %|5%}
	ChangeTitle 66 {Pagination Ciculaire          }
	ChangeTitle 67 {Délais avant le changement de page:                }
	ChangeTitle 69 {ms}
	ChangeTitle 70 {Résistance pour changer de page une fenètre:       }
	ChangeTitle 72 {pixels}
	ChangeTitle 73 {Épaisseur des fenètres de pagination (si active):     }
	ChangeTitle 75 {pixels}
	### Mouse Parameters
	ChangeTitle 76 {Paramètres pour la Souris}
	ChangeTitle 77 {Délais maximum pour un double clique:           }
	ChangeTitle 79 {ms}
	ChangeTitle 80 {Distance minimal pour un porté de souris:       }
	ChangeTitle 82 {pixels}
	### Transient
	ChangeTitle 90 { Fenètres Transitoires }
	ChangeTitle 91 { Ne pas décorer les fenètres transitoires }
	ChangeTitle 92 { Si la fenètre maitre est mis en avant ces fenètres transitoires le sont aussi   }
	ChangeTitle 93 { Si la fenètre maitre est mis en arrière ces fenètres transitoires le sont aussi }
	ChangeTitle 94 { Activer la réciproque des 2 options précédentes (si elles sont actives)         }
	ChangeTitle 95 { Les fenètres transitoires prennent automatiquement le focus                     }
	# Animation speed
	ChangeTitle 96 {Vitesse d'animations pour l'ombrage, les menus et les déplacements (non interactifs)}
	ChangeTitle 97 {Nombre d'étapes pour l'ombrage:       }
	ChangeTitle 99 { Animer l'intérieur de la fenètre lors d'un ombrage                              }
	ChangeTitle 100 {Menus et Déplacements:         }
	ChangeTitle 101 {Vitesse (ms):          }
	ChangeTitle 103 {Liste des déplacements:          }
	ChangeTitle 105 {Exemples:      }
	# max 24
      	ChangeTitle 106 {Défault|Rapide|Immédiat|Lent|Lent/Rapide|Rapide/Lent}
	### Hints
	# no more that 39 characteres in title from 111 to 116
	ChangeTitle 110 { Accèpter les Indications du type suivant: (dites oui à tout!)}
	ChangeTitle 111 {Décores MWM}
	ChangeTitle 112 {OLD}
	ChangeTitle 113 {À l'exception de l'ombrage}
	ChangeTitle 114 {Fonctions MWM}
	ChangeTitle 115 {GNOME}
	ChangeTitle 116 {À l'exception des fenètres modales}
	### Busy cursor
	ChangeTitle 117 {Afficher le curseur "je suis occupé" lors des commandes suivantes}
	
	### 
	ChangeTitle 122 {Avancés: voir la page de manuel de fvwm2 (les défauts sont bons!)}
	ChangeTitle 123 {Limité le nombre de couleurs à:               }
	ChangeTitle 127 {Temps accordé à un module pour obtenir une réponse:        }
	### Preference
	ChangeTitle 950 {Thèmes et Fichers}
	Set $tmp = {Au démarrage la composente } $Component { courrante, provenant de "} $GF_CurrentTheme {", a été chargé}
	ChangeTitle 951 $tmp
	ChangeTitle 952 {Charger la configuration de:        }
	ChangeTitle 955 {Charger}
	ChangeTitle 956 {Thème pour sauvé:        }
	ChangeTitle 958 {En choisir un autre:            }
	ChangeTitle 960 {OK}
	ChangeTitle 961 {Préférences}
	ChangeTitle 962 {"Essayer" s'applique à tout et pas seulement à la page courrante                          }
	ChangeTitle 963 {"Défauts" recharge les défauts pour tout et pas seulement pour la page courrante           }
	ChangeTitle 964 {"Sauver" s'applique à tout et pas seulement à la page courrant                            }
	### end
	Set $l_ConfigLoaded = {Configuration Chargée}
	ChangeTitle 991 {Sauver}
	Set $l_SavedInternally = {Changements Sauvés (Localement)}
	Set $l_SavedExternally = {Changements Sauvés (Globalement)}
	ChangeTitle 992 {Essayer}
	Set $l_AppliedInternally = {Changement Appliqués Localement}
	Set $l_AppliedExternally = {Changement Appliqués Globalement}
	Set $l_NoEffectHere = {Ceci ne fait rien ici}
	Set $l_Error = {Erreur:}
	ChangeTitle 993 {Défauts}
	ChangeTitle 994 {Aide}
	ChangeTitle 995 {Quitter}
    End
    If $Lang == {ru} Then
    Begin
    End
    If $locateSet == 0 Then
    Begin
	# Head
	# Check for the first entries of 1 to 5
	ChangeTitle 1 {File|Personal themes|Quit}
	ChangeTitle 2 {Global Feel|Focus and Placement|Move & Resize|Paging & Mouse Parameters|Transient Windows & Animation|Hints & Advanced Parameters|Preferences...}
	ChangeTitle 3 {Bindings|Keybooard|Mouse|Applications|Stroke|Preferences...}
	ChangeTitle 4 {Look|Buttons|Colours|Menu Style|Window Look|Cursors|Preferences...}
	ChangeTitle 5 {Misc|Sound Effect|Background|Start|Preferences...}
	Set $l_OnlyGlobal = {Only Global Feel is implemented}
	### Focus
	# no more that 44 characteres in title from 10 to 17
	ChangeTitle 10 { Focus Policy }
	ChangeTitle 11 {Click on a window to get Focus}
	ChangeTitle 12 {The Focus follows mouse}
	ChangeTitle 13 {The Focus follows mouse but on the root}
	ChangeTitle 14 { Options for the Focus }
	ChangeTitle 15 {Click to Focus passes a click to the window}
	ChangeTitle 16 {A click on a window raises it}
	ChangeTitle 17 {The "ColorMap" follows the Focus}
	### Placement
	ChangeTitle 18 { Window Placement }
	ChangeTitle 19 { Placement is smart if there is free place, stairs if not}
	ChangeTitle 20 { Placement is smart if there is free place, active if not}
	ChangeTitle 21 { Placement is always clever }
	ChangeTitle 22 { Placement is always active }
	ChangeTitle 23 { Placement is always stairs }
	ChangeTitle 24 { Options for the Window Placement }
	ChangeTitle 25 { New windows take the focus }
	ChangeTitle 26 { Take into account the program specified position (PPosition hint) }
	### Move & Resize
	ChangeTitle 30 { Move and Resize }
	# No more than 25 characteres for 31, 32 and 33, be exact for 31
	ChangeTitle 31 {Resize:                 }
	ChangeTitle 32 {Opaque              }
	ChangeTitle 33 {Out Line            }
	# be exact
	ChangeTitle 34 {Use Opaque Move for windows which take less than           }
	# No more than 20
	ChangeTitle 36 {% of the screen}
	# Exactly for 37 & 40, fit in the box for the others
	ChangeTitle 37 {Position of the geometry window:          }
	ChangeTitle 38 {Centered               }
	ChangeTitle 39 {On the top left        }
	ChangeTitle 40 {Hide the geometry window for:             }
	ChangeTitle 41 {Resizing               }
	ChangeTitle 42 {Moving                 }
	# check
	ChangeTitle 43 { Activate this option only if your windows flash when moved }
	# Snap attraction
	ChangeTitle 44 { Attraction of the Windows during a Move }
	# be exact, but check 48 
	ChangeTitle 45 {Distance:     }
	ChangeTitle 47 {Context:      }
	ChangeTitle 48 {Icons & Windows|Same type|Windows|Icons|Icons, Windows & screen|Same type & screen|Windows & screen|Icons & screen}
	ChangeTitle 49 {Attraction Grid:      }
	ChangeTitle 54 { Color or Pixmap XOR for the Lines (and Stroke) }
	ChangeTitle 55 {Use a Color                  }
	ChangeTitle 56 {Use a Pixmap (xpm)                 }
#	ChangeTitle 57 {A color:           }
	Set $l_OneColor =  {A Color (pixels):         }
	Set $l_OnePixmap = {A Pixmap (xpm):           }
	# check
	Set $l_StartColorSel = {Palette}
	Set $l_StartImages = {Images}
	ChangeTitle 59 $l_StartColorSel
	### Pagination (be exact for 61,64,67,70,73); check the others
	ChangeTitle 60 { Paging }
	ChangeTitle 61 {Horizontal Paging:            }
	ChangeTitle 62 {Disabled|100 %|90 %|75 %|66 %|50 %|33 %|25 %|10 %|5%}
	ChangeTitle 63 {Circular Paging               }
	ChangeTitle 64 {Vertical Paging               }
	ChangeTitle 65 {Disabled|100 %|90 %|75 %|66 %|50 %|33 %|25 %|10 %|5%}
	ChangeTitle 66 {Circular Paging               }
	ChangeTitle 67 {Delay before a page switching:                     }
	ChangeTitle 69 {msec}
	ChangeTitle 70 {Resistance for moving a window between pages:      }
	ChangeTitle 72 {pixels}
	ChangeTitle 73 {Edge thickness when paging (if enabled):              }
	ChangeTitle 75 {pixels}
	### Mouse Parameters (be exact for 77,80)
	ChangeTitle 76 { Mouse parameters }
	ChangeTitle 77 {Maximal delay for a double click:               }
	ChangeTitle 79 {msec}
	ChangeTitle 80 {Minimal distance for a mouse drag:              }
	ChangeTitle 82 {pixels}
	### Transient (check)
	ChangeTitle 90 { Transient Windows }
	ChangeTitle 91 { Do not decorate transient windows }
	ChangeTitle 92 { Raise all window transients together with the parent window }
	ChangeTitle 93 { Lower all window transients together with the parent window }
	# this boolean should be reversed, with the default "true"
	ChangeTitle 94 { Don't transfer raise/lower action from the transient to the parent }
	ChangeTitle 95 { A new transient window automaticaly takes the focus }
	# Animation speed
	ChangeTitle 96 { Animation for shading, menus and animated moves }
	# be exact for 97,100,101,103,105, use the box for 99
	ChangeTitle 97 {Number of steps for shading:          }
	ChangeTitle 99 { Animate the interior of the window when shading                                 }
	ChangeTitle 100 {Menus and animated Move:       }
	ChangeTitle 101 {Speed (msec):          }
	ChangeTitle 103 {List of the positions:           }
	ChangeTitle 105 {Examples:      }
	# max 24
      	ChangeTitle 106 {Default|Fast|Immediate|Slow|Slow/Fast|Fast/Slow}
	### Hints
	# no more that 39 characteres in title from 111 to 116
	ChangeTitle 110 { Use the hints of the following types (say yes to all!) }
	ChangeTitle 111 {MWM Decor}
	ChangeTitle 112 {OLD Hints}
	ChangeTitle 113 {Ignore shading hints}
	ChangeTitle 114 {MWM Function}
	ChangeTitle 115 {GNOME Hints}
	ChangeTitle 116 {Ignore modality hints}
	### Busy cursor
	ChangeTitle 117 { Display the Busy Cursor during execution of the following commands }
	### Advanced
	ChangeTitle 122 { Advanced: see fvwm2 manual page (defaults are good!) }
	# be exact with 123 and 127
	ChangeTitle 123 {Limit the numbers of colors to:               }
	ChangeTitle 127 {Maximal time given to a module to return an answer:       }
	### Preferences
	ChangeTitle 950 { Themes and Files }
	Set $tmp = {At start the current component } $Component {, from the theme } $GF_CurrentTheme {, has been loaded}
	ChangeTitle 951 $tmp
	# exact, but check for 955,960 
	ChangeTitle 952 {Load the configuration from:        }
	ChangeTitle 955 {Load}
	ChangeTitle 956 {Theme for saving:        }
	ChangeTitle 958 {Choose another one:             }
	ChangeTitle 960 {OK}
	# Preference
	ChangeTitle 961 { Preferences }
	ChangeTitle 962 {Apply "Try" to the all globalfeel screens, not only to the current one }
	ChangeTitle 963 {Apply "Default" to the all globalfeel screens, not only to the current one }
	ChangeTitle 964 {Apply "Save" to the all globalfeel screens, not only to the current one }
	### end
	Set $l_ConfigLoaded = { Configuration Loaded }
	ChangeTitle 991 {Save}
	Set $l_SavedInternally = { Modifications Saved (Internally)}
	Set $l_SavedExternally = { Modifications Saved (Globally)}
	ChangeTitle 992 {Try}
	Set $l_AppliedInternally = { Modifications Applied Internally}
	Set $l_AppliedExternally = { Modifications Applied Globally}
	Set $l_NoEffectHere = { This has no effect here }
	Set $l_Error = {Error:}
	ChangeTitle 993 {Default}
	ChangeTitle 994 {Help}
	ChangeTitle 995 {Quit}
    End



    ChangeFont 991 $ShadeFont
    Set $SaveFont = {Sel}
    ChangeFont 992 $ShadeFont
    Set $TryFont = {Shade}

#------------------------------------------------------------------------------
# Main variables, i.e. "Global one" (see also the com loop init !)

    ### Perodic Task Test:
    Set $GF_UpdateConfig = 1
    Set $GF_BuildConfig = 1
    Set $GF_BuildAllConfig = 1
    # Others:
    # $UpdateButtonFont
    # Is the color sel is up for XorValue ? (GF)
    Set $GF_XorBrowser = {}

    ### CommonFeel specific (initialized during $GF_BuilConfig = 1)
    # $GF_Focus, $GF_Placement, $GF_ResizeOutLine,  $GF_Emulate, 
    # $GF_HideGeoSize, $HideGeoMove, $GF_Xor, $GF_XorPixmap, $GF_XorValue,
    # GF Hide/Show{Focus,Move,Paging,Transient,Hints}

    Set $ThemeToLoad = {current}
    Set $InStart = 1

    Set $MetaConfigTool = {CommonFeel}
    Set $ConfigTool = {Focus}
    
    # Preference
    Set $GF_TryIsGlobal = 0
    Set $GF_DefaultIsGlobal = 0
    Set $GF_SaveIsGlobal = 0

    # type of command for Apply and save
    Set $CmdType = {}

    # not yet implemented
    ChangeFont 1 $ShadeFont
    ChangeFont 3 $ShadeFont
    ChangeFont 4 $ShadeFont
    ChangeFont 5 $ShadeFont

    Do {All (FvwmScript-NoteMessage) Delete}
End

# ---------------------------------------------------------------------------
#
# Periodic Task
#
# ---------------------------------------------------------------------------

PeriodicTasks
Begin

#----------------------------------------------------------------------------
# Build (Update) the config

    If $GF_UpdateConfig == 1 Then
    Begin
	Set $GF_UpdateConfig = 0
	If $InStart == 1 Then
	Begin
	    Set $LoadFocus = 1
	    Set $LoadMove = 1
	    Set $LoadPaging = 1
	    Set $LoadTransient = 1
	    Set $LoadHints = 1
	    Set $GF_BuildConfig = 1
	    Set $GF_BuildAllConfig = 1
	End
	Else
	Begin
	    Set $test = 1
	    Set $tmp = 1
	    If $LoadFromPreference == 1 Then
		Set $test = 0
	    Set $LoadFromPreference = 0
	    If $GF_DefaultIsGlobal == 1 Then
		Set $tmp = 0
	    Set $test = (Mult $test $tmp)
	    If $test == 0 Then
	    Begin
		Set $LoadFocus = 1
		Set $LoadMove = 1
		Set $LoadPaging = 1
		Set $LoadTransient = 1
		Set $LoadHints = 1
		Set $ct = {All}
		Set $GF_BuildAllConfig = 1
	    End
	    Else
	    Begin
		Set $GF_BuildConfig = 1
		Set $LoadFocus = 0
		Set $LoadMove = 0
		Set $LoadPaging = 0
		Set $LoadTransient = 0
		Set $LoadHints = 0
		Set $ct = $ConfigTool
		If $ct == {Focus} Then
		   Set $LoadFocus = 1
 		If $ct == {Move} Then
		   Set $LoadMove = 1
  		If $ct == {Paging} Then
		   Set $LoadPaging = 1
   		If $ct == {Transient} Then
		   Set $LoadTransient = 1
  		If $ct == {Hints} Then
		   Set $LoadHints = 1
	    End
	    Set $cmd = $SendMsgAndGet{"get-config }$ThemeToLoad{ }$GF_FileName{ }$ct{" --line=1}
	    Set $error = (GetOutput $cmd 1 -1)
	    Set $cmd = $GetLine{2 --clear-buffer}
	    Set $GF_Config = (GetOutput $cmd 1 -1)
	End

	If $error <> {0} Then
	Begin
	    Set $LoadFocus = 0
	    Set $LoadMove = 0
	    Set $LoadPaging = 0
	    Set $LoadTransient = 0
	    Set $LoadHints = 0
	    Set $msg = $error{ (when loading }$ThemeToLoad{)}
	End
	Else
	    Set $msg = $l_ConfigLoaded

	Set $index = 0
	### Focus
	If $LoadFocus == 1 Then
	Begin
	    Set $index = (Add $index 1)
	    Set $tmp = 11
	    While $tmp <> 24 Do
	    Begin
		ChangeValue $tmp 0
		Set $tmp = (Add $tmp 1)
	    End
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    Set $GF_Focus = (Add 10 $tmp)
	    ChangeValue $GF_Focus 1
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 15 $tmp
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 16 $tmp
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 17 $tmp
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    Set $GF_Placement = (Add 18 $tmp)
	    ChangeValue $GF_Placement 1
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 25 $tmp
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 26 $tmp
	End
	### Move
	If $LoadMove == 1 Then
	Begin
	    # Opaque/OutLine
	    ChangeValue 32 0
	    ChangeValue 33 0
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    Set $GF_ResizeOutLine = (Add 32 $tmp)
	    ChangeValue $GF_ResizeOutLine 1
	    # ResizeOpaque
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    Set $value = {}
	    While $tmp <> {!} Do
	    Begin
		Set $value = $value $tmp
		Set $index = (Add $index 1)
		Set $tmp = (StrCopy $GF_Config $index $index)
		If $index > 3200 Then
		    Set $tmp = {!}
	    End
	    ChangeTitle 35 $value
	    # Emulate
	    ChangeValue 38 0
	    ChangeValue 39 0
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    Set $GF_Emulate = (Add 38 $tmp)
	    ChangeValue $GF_Emulate 1
	    # Hide Geo
	    Set $index = (Add $index 1)
	    Set $GF_HideGeoSize = (StrCopy $GF_Config $index $index)
	    ChangeValue 41 $GF_HideGeoSize
	    Set $index = (Add $index 1)
	    Set $GF_HideGeoMove = (StrCopy $GF_Config $index $index)
	    ChangeValue 42 $GF_HideGeoMove
	    # FlickeringMoveWorkaround
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 43 $tmp
	    # Snap distance
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    Set $value = {}
	    While $tmp <> {!} Do
	    Begin
		Set $value = $value $tmp
		Set $index = (Add $index 1)
		Set $tmp = (StrCopy $GF_Config $index $index)
		If $index > 3200 Then
		    Set $tmp = {!}
	    End
	    ChangeTitle 46 $value
	    # Snap behavior
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 48 $tmp
	    # Snap Grid X
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    Set $value = {}
	    While $tmp <> {!} Do
	    Begin
		Set $value = $value $tmp
		Set $index = (Add $index 1)
		Set $tmp = (StrCopy $GF_Config $index $index)
		If $index > 3200 Then
		    Set $tmp = {!}
	    End
	    ChangeTitle 51 $value
	    # Snap Grid Y
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    Set $value = {}
	    While $tmp <> {!} Do
	    Begin
		Set $value = $value $tmp
		Set $index = (Add $index 1)
		Set $tmp = (StrCopy $GF_Config $index $index)
		If $index > 3200 Then
		    Set $tmp = {!}
	    End
	    ChangeTitle 53 $value
	    # XOR
	    ChangeValue 55 0
	    ChangeValue 56 0
	    Set $index = (Add $index 1)
	    Set $GF_Xor = (StrCopy $GF_Config $index $index)
	    Set $tmp = (Add $GF_Xor 55)
	    ChangeValue $tmp 1
	    # XorValue
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    Set $value = {}
	    While $tmp <> {!} Do
	    Begin
		Set $value = $value $tmp
		Set $index = (Add $index 1)
		Set $tmp = (StrCopy $GF_Config $index $index)
		If $index > 3200 Then
		    Set $tmp = {!}	
	    End
	    Set $GF_XorValue = $value
	    # XorPixmap
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    Set $value = {}
	    While $tmp <> {!} Do
	    Begin
		Set $value = $value $tmp
		Set $index = (Add $index 1)
		Set $tmp = (StrCopy $GF_Config $index $index)
		If $index > 3200 Then
		    Set $tmp = {!}
	    End
	    Set $GF_XorPixmap = $value
	    If $GF_Xor == 0 Then
	    Begin
		ChangeTitle 58 $GF_XorValue
		ChangeTitle 57 $l_OneColor
		ChangeTitle 59 $l_StartColorSel
	    End
	    Else
	    Begin
		ChangeTitle 58 $GF_XorPixmap
		ChangeTitle 57 $l_OnePixmap
		ChangeTitle 59 $l_StartImages
	    End
	End
	### Paging
	If $LoadPaging == 1 Then
	Begin
	    # Horizontal:
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    Set $tmp = (Add 1 $tmp)
	    ChangeValue 62 $tmp
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 63 $tmp
	    # Vertical:
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    Set $tmp = (Add 1 $tmp)
	    ChangeValue 65 $tmp
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 66 $tmp
	    # Resitance
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    Set $value = {}
	    While $tmp <> {!} Do
	    Begin
		Set $value = $value $tmp
		Set $index = (Add $index 1)
		Set $tmp = (StrCopy $GF_Config $index $index)
		If $index > 3200 Then
		    Set $tmp = {!}
	    End
	    ChangeTitle 68 $value
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    Set $value = {}
	    While $tmp <> {!} Do
	    Begin
		Set $value = $value $tmp
		Set $index = (Add $index 1)
		Set $tmp = (StrCopy $GF_Config $index $index)
		If $index > 3200 Then
		    Set $tmp = {!}
	    End
	    ChangeTitle 71 $value
	    # thickness
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 74 $tmp
	    # Click time
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    Set $value = {}
	    While $tmp <> {!} Do
	    Begin
		Set $value = $value $tmp
		Set $index = (Add $index 1)
		Set $tmp = (StrCopy $GF_Config $index $index)
		If $index > 3200 Then
		    Set $tmp = {!}
	    End
	    ChangeTitle 78 $value
	    # MoveThreshold
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    Set $value = {}
	    While $tmp <> {!} Do
	    Begin
		Set $value = $value $tmp
		Set $index = (Add $index 1)
		Set $tmp = (StrCopy $GF_Config $index $index)
		If $index > 3200 Then
		    Set $tmp = {!}
	    End
	    ChangeTitle 81 $value
	End
	### Transient
	If $LoadTransient == 1 Then
	Begin
	    # NakedTransient
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 91 $tmp
	    # RaiseTransient
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 92 $tmp
	    # LowerTransient
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 93 $tmp
	    # StackTransientParent
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 94 $tmp
	    # GrabFocusTransient
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 95 $tmp
	    # WindowShadeSteps
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    Set $value = {}
	    While $tmp <> {!} Do
	    Begin
		Set $value = $value $tmp
		Set $index = (Add $index 1)
		Set $tmp = (StrCopy $GF_Config $index $index)
		If $index > 3200 Then
		    Set $tmp = {!}		
	    End
	    ChangeTitle 98 $value
	    # WindowShadeScrolls
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 99 $tmp
	    # SetAnimation: speed 
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    Set $value = {}
	    While $tmp <> {!} Do
	    Begin
		Set $value = $value $tmp
		Set $index = (Add $index 1)
		Set $tmp = (StrCopy $GF_Config $index $index)
		If $index > 3200 Then
		    Set $tmp = {!}
	    End
	    ChangeTitle  102 $value
	    # SetAnimation: frac 
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    Set $value = {}
	    While $tmp <> {!} Do
	    Begin
		Set $value = $value $tmp
		Set $index = (Add $index 1)
		Set $tmp = (StrCopy $GF_Config $index $index)
		If $index > 3200 Then
		    Set $tmp = {!}
	    End
	    ChangeTitle 104 $value
	End
	### Hints
	If $LoadHints == 1 Then
	Begin
	    Set $t = 111
	    While $t <> 117 Do
	    Begin
		Set $index = (Add $index 1)
		Set $tmp = (StrCopy $GF_Config $index $index)
		ChangeValue $t $tmp
		Set $t = (Add $t 1)
	    End
	    # BusyCursor
	    Set $t = 118
	    While $t <> 122 Do
	    Begin
		Set $index = (Add $index 1)
		Set $tmp = (StrCopy $GF_Config $index $index)
		ChangeValue $t $tmp
		Set $t = (Add $t 1) 
	    End
	    # color limit
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 124 $tmp
	    # MixedVisualWorkArround
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 125 $tmp
	    # RaiseOverNativeWindows
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 126 $tmp
	    # SaveUnder
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 129 $tmp
	    # BackingStore
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 130 $tmp
	    # ModuleTimeOut
	    Set $index = (Add $index 1)
	    Set $tmp = (StrCopy $GF_Config $index $index)
	    ChangeValue 128 $tmp
	End

	If $index > 3200 Then
	Begin
	    Do {Echo ConfigCenter: problems when loading globalfeel config!}
	    Do {Echo ConfigCenter: can you send a bug report to:}
	    Do {Echo ConfigCenter: <fvwm-themes-devel@lists.sourceforge.net>}
	    SendSignal 995 1
	End

	If $InStart == 1 Then
	Begin
	    Set $GF_ShowFocus = 1
	End
	
	ChangeTitle 990 $msg
    End

#----------------------------------------------------------------------------
# config tool switching

    If $GF_HideFocus == {1} Then
    Begin
	Set $GF_HideFocus = 0
	Set $tmp = 10
	While $tmp <> 27 Do
	Begin
	    HideWidget $tmp
 	    Set $tmp = (Add $tmp 1)
	End
    End

    If $GF_HideMove == {1} Then
    Begin
	Set $GF_HideMove = 0
	Set $tmp = 30
	While $tmp <> 60 Do
	Begin
	    HideWidget $tmp
 	    Set $tmp = (Add $tmp 1)
	End
    End

    If $GF_HidePaging == {1} Then
    Begin
	Set $GF_HidePaging = 0
	Set $tmp = 60
	While $tmp <> 83 Do
	Begin
	    HideWidget $tmp
 	    Set $tmp = (Add $tmp 1)
	End
    End

    If $GF_HideTransient == {1} Then
    Begin
	Set $GF_HideTransient = 0
	Set $tmp = 90
	While $tmp <> 107 Do
	Begin
	    HideWidget $tmp
 	    Set $tmp = (Add $tmp 1)
	End
    End

    If $GF_HideHints == {1} Then
    Begin
	Set $GF_HideHints = 0
	Set $tmp = 110
	While $tmp <> 131 Do
	Begin
	    HideWidget $tmp
 	    Set $tmp = (Add $tmp 1)
	End
    End

    If $GF_HidePreference == {1} Then
    Begin
	Set $GF_HidePreference = 0
	Set $tmp = 950
	While $tmp <> 965 Do
	Begin
	    HideWidget $tmp
 	    Set $tmp = (Add $tmp 1)
	End
    End

    If $GF_ShowFocus == {1} Then
    Begin
	Set $GF_ShowFocus = 0
	Set $ConfigTool = {Focus}
	Set $tmp = 10
	While $tmp <> 27 Do
	Begin
	    ShowWidget $tmp
 	    Set $tmp = (Add $tmp 1)
	End
    End

    If $GF_ShowMove == {1} Then
    Begin
	Set $GF_ShowMove = 0
	Set $ConfigTool = {Move}
	Set $tmp = 30
	While $tmp <> 60 Do
	Begin
	    ShowWidget $tmp
 	    Set $tmp = (Add $tmp 1)
	End
    End

    If $GF_ShowPaging == {1} Then
    Begin
	Set $GF_ShowPaging = 0
	Set $ConfigTool = {Paging}
	Set $tmp = 60
	While $tmp <> 83 Do
	Begin
	    ShowWidget $tmp
 	    Set $tmp = (Add $tmp 1)
	End
    End

    If $GF_ShowTransient == {1} Then
    Begin
	Set $GF_ShowTransient = 0
	Set $ConfigTool = {Transient}
	Set $tmp = 90
	While $tmp <> 107 Do
	Begin
	    ShowWidget $tmp
 	    Set $tmp = (Add $tmp 1)
	End
    End

    If $GF_ShowHints == {1} Then
    Begin
	Set $GF_ShowHints = 0
	Set $ConfigTool = {Hints}
	Set $tmp = 110
	While $tmp <> 131 Do
	Begin
	    ShowWidget $tmp
 	    Set $tmp = (Add $tmp 1)
	End
    End
    
    If $GF_ShowPreference == {1} Then
    Begin
	Set $GF_ShowPreference = 0
	Set $ConfigTool = {Preference}
	Set $tmp = 950
	While $tmp <> 965 Do
	Begin
	    ShowWidget $tmp
 	    Set $tmp = (Add $tmp 1)
	End
    End

#----------------------------------------------------------------------------
# Update "font" : first part

    If (RemainderOfDiv (GetTime) 2)==0 Then
    Begin
        If $ConfigTool <> {Preference} Then
	Begin
	    Set $UpdateButtonFont = 1
	    Set $GF_BuildConfig = 1
	End
    End
	
#----------------------------------------------------------------------------
# Build config for fvwm-themes-script:

    If $GF_BuildConfig == 1 Then
    Begin
	Set $GF_BuildConfig = 0

	# Focus
	Set $tmp = (Add $GF_Focus -10)
	Set $t = (Add $GF_Placement -18)
	Set $GF_LastConfigFocus = $tmp (GetValue 15) (GetValue 16) (GetValue 17) $t (GetValue 25) (GetValue 26)
	# Move
	Set $tmp = (Add $GF_ResizeOutLine  -32)
	Set $t = (Add $GF_Emulate -38)
	Set $GF_LastConfigMove = $tmp (GetTitle 35) {!} $t (GetValue 41) (GetValue 42) (GetValue 43) (GetTitle 46) {!} (GetValue 48) (GetTitle 51) {!} 
	Set $GF_LastConfigMove = $GF_LastConfigMove (GetTitle 53) {!} $GF_Xor (GetTitle 58) {!}
	# Paging
	Set $tmp = (Add  (GetValue 62)  -1)
	Set $t = (Add (GetValue 65) -1)
	Set $GF_LastConfigPaging = $tmp (GetValue 63) $t (GetValue 66) (GetTitle 68) {!} (GetTitle 71) {!} (GetValue 74) (GetTitle 78) {!} (GetTitle 81) {!}
	# Transient
	Set $GF_LastConfigTransient = (GetValue 91) (GetValue 92) (GetValue 93) (GetValue 94) (GetValue 95) (GetTitle 98) {!} (GetValue 99) (GetTitle 102) {!} (GetTitle 104) {!}
	# Hints
	Set $GF_LastConfigHints = (GetValue 111) (GetValue 112) (GetValue 113) (GetValue 114) (GetValue 115) (GetValue 116) (GetValue 118) (GetValue 119) (GetValue 120) (GetValue 121) 
	Set $GF_LastConfigHints = $GF_LastConfigHints (GetValue 124) (GetValue 125) (GetValue 126) (GetValue 129) (GetValue 130) (GetValue 128)

	Set $GF_LastConfig = $GF_LastConfigFocus $GF_LastConfigMove $GF_LastConfigPaging $GF_LastConfigTransient $GF_LastConfigHints 
	Set $test1 = 0
	Set $test2 = 0
	If $InStart == 1 Then
	Begin
	    Set $test1 = 1
	    Set $test2 = 1
	End
	Else
	Begin
	    If $CmdType == {Try} Then
		Set $test1 = 1
	    If $CmdType == {Save} Then
		Set $test2 = 1
	End

	If $GF_BuildAllConfig == 1 Then
	Begin
	    Set $GF_BuildAllConfig = 0
	    If $test1 == 1 Then
	    Begin
		Set $GF_TryConfigFocus = $GF_LastConfigFocus
		Set $GF_TryConfigMove = $GF_LastConfigMove
		Set $GF_TryConfigPaging = $GF_LastConfigPaging
		Set $GF_TryConfigTransient = $GF_LastConfigTransient 
		Set $GF_TryConfigHints = $GF_LastConfigHints
	    End
	    If $test2 == 1 Then
	    Begin
		Set $GF_SaveConfigFocus = $GF_LastConfigFocus
		Set $GF_SaveConfigMove = $GF_LastConfigMove
		Set $GF_SaveConfigPaging = $GF_LastConfigPaging
		Set $GF_SaveConfigTransient = $GF_LastConfigTransient 
		Set $GF_SaveConfigHints = $GF_LastConfigHints
	    End
	End
	
	Else
	Begin
	    If $test1 == 1 Then
	    Begin
		If $ConfigTool == {Focus} Then
		    Set $GF_TryConfigFocus = $GF_LastConfigFocus
		If $ConfigTool == {Move} Then
		    Set $GF_TryConfigMove = $GF_LastConfigMove
		If $ConfigTool == {Paging} Then
		    Set $GF_TryConfigPaging = $GF_LastConfigPaging
		If $ConfigTool == {Transient} Then
		    Set $GF_TryConfigTransient = $GF_LastConfigTransient
		If $ConfigTool == {Hints} Then
		    Set $GF_TryConfigHints = $GF_LastConfigHints
	    End
	    If $test2 == 1 Then
	    Begin
		If $ConfigTool == {Focus} Then
		    Set $GF_SaveConfigFocus = $GF_LastConfigFocus
		If $ConfigTool == {Move} Then
		    Set $GF_SaveConfigMove = $GF_LastConfigMove
		If $ConfigTool == {Paging} Then
		    Set $GF_SaveConfigPaging = $GF_LastConfigPaging
		If $ConfigTool == {Transient} Then
		    Set $GF_SaveConfigTransient = $GF_LastConfigTransient
		If $ConfigTool == {Hints} Then
		    Set $GF_SaveConfigHints = $GF_LastConfigHints
	    End
	End
	
	If $test1 == 1 Then 
	    Set $GF_TryConfig = $GF_TryConfigFocus $GF_TryConfigMove $GF_TryConfigPaging $GF_TryConfigTransient $GF_TryConfigHints
	If $test2 == 1 Then 
	Set $GF_SaveConfig = $GF_SaveConfigFocus $GF_SaveConfigMove $GF_SaveConfigPaging $GF_SaveConfigTransient $GF_SaveConfigHints

	If $InStart == 1 Then
	Begin
	    Set $InStart = 0
	    Set $GF_CurrentConfig = $GF_TryConfig
	End
    End

# ----------------------------------------------------------------------------
# Apply and Try
    
    If $DoApplyCmd == 1 Then
    Begin
	Set $DoApplyCmd = 0

	If $CmdType == {Try} Then
	Begin
	    If $GF_TryIsGlobal == 0 Then
	    Begin
		Set $msg = $l_AppliedInternally
		Set $tmp = $ConfigTool
	    End
	    Else
	    Begin
		Set $msg = $l_AppliedExternally
		Set $tmp = {All}
	    End
	    Set $conf = $GF_TryConfig
	End
	
	If $CmdType == {Save} Then
	Begin
	    If $GF_SaveIsGlobal == 0 Then
	    Begin
		Set $msg = $l_SavedInternally
		Set $tmp = $ConfigTool
	    End
	    Else
	    Begin
		Set $msg = $l_SavedExternally
		Set $tmp = {All}
	    End
	    Set $conf = $GF_SaveConfig
	End

	Set $cmd = $SendMsgAndGet{'save-try-config }$Component{ }$tmp{ 0 }$conf{'}
	Set $check = (GetOutput $cmd 1 -1)
 	If $check == {ok} Then
	Begin
	    If $CmdType == {Try} Then
	    Begin
		Set $cmd = $SendMsgAndGet{'save-try-last-build 1'}
		Do {PipeRead "}$cmd{"}
		Set $GF_CurrentConfig = $GF_TryConfig
	    End
	    If $CmdType == {Save} Then
	    Begin
		# there some problems here ...
		If $GF_SaveConfig <> $GF_CurrentConfig Then
		Begin
		   Set $cmd = $SendMsgAndGet{'save-try-last-build 3'}
		   Do {PipeRead "}$cmd{"} 
		   Set $msg = $msg { and Pipe}
		   Set $GF_TryConfig = $GF_SaveConfig
		   Set $GF_TryConfigFocus = $GF_SaveConfigFocus
		   Set $GF_TryConfigMove = $GF_SaveConfigMove
		   Set $GF_TryConfigPaging = $GF_SaveConfigPaging
		   Set $GF_TryConfigTransient = $GF_SaveConfigTransient 
		   Set $GF_TryConfigHints = $GF_SaveConfigHints
		End
		Else
		Begin
		    Set $cmd = $SendMsgAndGet{'save-try-last-build 2'}
		    Do {Exec }$cmd
		End
		Set $GF_CurrentConfig = $GF_SaveConfig
	    End
	End
	Else
	Begin
	    Set $msg = $l_Error { }$check
	End
	ChangeTitle 990 $msg
	Set $CmdType = {}
    End

#----------------------------------------------------------------------------
# Update "font" : 2nd part

    If $UpdateButtonFont == 1 Then
    Begin
	Set $UpdateButtonFont = 0
	# Update Try font
	Set $test = 1
	If $GF_TryIsGlobal == 1 Then
	Begin
	    If $GF_TryConfig == $GF_LastBConfig Then
		Set $test = 0
	End
	Else
	Begin
	    If $ConfigTool == {Focus} Then
	    Begin
		If $GF_TryConfigFocus == $GF_LastConfigFocus Then
		    Set $test = 0
	    End
	    If $ConfigTool == {Move} Then
	    Begin
		If $GF_TryConfigMove == $GF_LastConfigMove Then
		    Set $test = 0
	    End
	    If $ConfigTool == {Paging} Then
	    Begin
		If $GF_TryConfigPaging == $GF_LastConfigPaging Then
		    Set $test = 0
	    End
	    If $ConfigTool == {Transient} Then
	    Begin
		If $GF_TryConfigTransient == $GF_LastConfigTransient Then
		    Set $test = 0
	    End
	    If $ConfigTool == {Hints} Then
	    Begin
		If $GF_TryConfigHints == $GF_LastConfigHints  Then
		    Set $test = 0
	    End
	End
	If $test == 0 Then
	Begin
	    If $TryFont == {Sel} Then
	    Begin
		ChangeFont 992 $ShadeFont
		Set $TryFont = {Shade}
	    End
	End
	Else
	Begin
	    If $TryFont == {Shade} Then
	    Begin
		ChangeFont 992 $SelFont
		Set $TryFont = {Sel}
	    End
	End
	
	# Update Save font
	Set $test = 1
	If $GF_SaveIsGlobal == 1 Then
	Begin
	    If $GF_SaveConfig == $GF_LastBConfig Then
		Set $test = 0
	End
	Else
	Begin
	    If $ConfigTool == {Focus} Then
	    Begin
		If $GF_SaveConfigFocus == $GF_LastConfigFocus Then
		    Set $test = 0
	    End
	    If $ConfigTool == {Move} Then
	    Begin
		If $GF_SaveConfigMove == $GF_LastConfigMove Then
		    Set $test = 0
	    End
	    If $ConfigTool == {Paging} Then
	    Begin
		If $GF_SaveConfigPaging == $GF_LastConfigPaging Then
		    Set $test = 0
	    End
	    If $ConfigTool == {Transient} Then
	    Begin
		If $GF_SaveConfigTransient == $GF_LastConfigTransient Then
		    Set $test = 0
	    End
	    If $ConfigTool == {Hints} Then
	    Begin
		If $GF_SaveConfigHints == $GF_LastConfigHints  Then
		    Set $test = 0
	    End
	End
	If $test == 0 Then
	Begin
	    If $SaveFont == {Sel} Then
	    Begin
		ChangeFont 991 $ShadeFont
		Set $SaveFont = {Shade}
	    End
	End
	Else
	Begin
	    If $SaveFont == {Shade} Then
	    Begin
		ChangeFont 991 $SelFont
		Set $SaveFont = {Sel}
	    End
	End
    End
#----------------------------------------------------------------------------
# Messages
    
    If $GF_XorBrowser <> {} Then
    Begin
	Set $msg = (ReceivFromScript $GF_XorBrowser)
	If $msg <> {No message} Then
	Begin
	    Set $GF_XorBrowser = {}
	    If $msg <> {Cancel} Then
	    Begin
		If $GF_Xor == 1 Then
		    Set $GF_XorPixmap = $msg
		Else
		Begin
		    # Hex -> Value conversion
		    Set $cmd = $SendMsgAndGet{"hexcolor-2-value }$msg{"}
		    Set $msg = (GetOutput $cmd 1 -1)
		    Set $GF_XorValue = $msg
		End
		ChangeTitle 58 $msg
	    End
	End
    End

    If $NullMessage == {1} Then
    Begin
	Set $NullMessage = 0
	Set $msg = {}
	ChangeTitle 990 $msg
    End

    If $SpecialMessage <> {} Then
    Begin
	ChangeTitle 990 $SpecialMessage
	Set $SpecialMessage = {}
    End

End

# ---------------------------------------------------------------------------
#
# Now the widgets
#
# ---------------------------------------------------------------------------

# ---------------------------------------------------------------------------
#
# Head: GUI chooser and rectangle delimiter
#
# ---------------------------------------------------------------------------

Widget 1
Property
    Flags NoReliefString
    Position 90 10
    Size 175 20
    Type Menu
    Title {                           }
Main
Case message of
 SingleClic :
 Begin
    Set $tmp = (GetValue 1)
    If $tmp == 1 Then
    Begin
    End
    If $tmp == 2 Then
	SendSignal 995 1
    ChangeTitle 990 $l_OnlyGlobal	
 End
End

Widget 2
Property
    Flags NoReliefString
    Position 270 5
    Type Menu
    Title {                          }
Main
Case message of
 SingleClic :
 Begin
    Set $tmp = (GetValue 2)
    If $tmp <> 0 Then
    Begin
	Set $Component = {globalfeel}
	Set $GF_HideFocus = 1
	Set $GF_HideMove = 1
	Set $GF_HidePaging = 1
	Set $GF_HideTransient = 1
	Set $GF_HideHints = 1
	Set $GF_HidePreference = 1
	Set $NullMessage = 1
    End
    If $tmp == 1 Then
    Begin
	Set $GF_ShowFocus = 1
	Set $GF_HideFocus = 0
    End
    If $tmp == 2 Then
    Begin
	Set $GF_ShowMove = 1
	Set $GF_HideMove = 0
    End
    If $tmp == 3 Then
    Begin
	Set $GF_ShowPaging = 1
	Set $GF_HidePaging = 0
    End
    If $tmp == 4 Then
    Begin
	Set $GF_ShowTransient = 1
	Set $GF_HideTransient = 0
    End
    If $tmp == 5 Then
    Begin
	Set $GF_ShowHints = 1
	Set $GF_HideHints = 0
    End
    If $ConfigTool == {Preference} Then
	ChangeFont 993 $SelFont
    If $tmp == 6 Then
    Begin
	Set $GF_ShowPreference = 1
	Set $GF_HidePreference = 0
	If $TryFont <> {Shade} Then
	Begin
	    ChangeFont 992 $ShadeFont
	    Set $TryFont = {Shade}
	End
	If $SaveFont <> {Sel} Then
	Begin
	    ChangeFont 991 $SelFont
	    Set $SaveFont = {Sel}
	End
	ChangeFont 993 $ShadeFont
    End
 End
End

Widget 3
Property
    Flags NoReliefString
    Position 90 10
    Size 175 20
    Type Menu
    Title {                           } 
Main
Case message of
 SingleClic :
 Begin
    ChangeTitle 990 $l_OnlyGlobal
 End
End

Widget 4
Property
    Flags NoReliefString
    Position 90 10
    Size 175 20
    Type Menu
    Title {                           }
Main
Case message of
 SingleClic :
 Begin
    ChangeTitle 990 $l_OnlyGlobal
 End
End

Widget 5
Property
    Flags NoReliefString
    Position 90 10
    Size 175 20
    Type Menu
    Title {                           }
Main
Case message of
 SingleClic :
 Begin
    ChangeTitle 990 $l_OnlyGlobal
 End
End


Widget 9
Property
    Size 600 410
    Position 5 35
    Type Rectangle
Main
Case message of
    SingleClic :
    Begin
    End
End

##############################################################################
#
# Global Feel
#
##############################################################################

#-----------------------------------------------------------------------------
#
# Focus and Placement
#
#-----------------------------------------------------------------------------

# Focus Title:
Widget 10
Property
    Size 280 15
    Position 15 50
    Type ItemDraw
    Flags NoReliefString Hidden
    Title {Load Configuration ...}
Main
Case message of
    SingleClic :
    Begin
    End
End

# ClicToFocus
Widget 11
Property
    Position 15 80
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden
    Title {                                           }
Main
Case message of
SingleClic :
 Begin
    ChangeValue $GF_Focus 0
    ChangeValue 11 1
    Set $GF_Focus = 11
 End
End

# MouseFocus
Widget 12
Property
    Position 15 105
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                           }
Main
Case message of
SingleClic :
 Begin
    ChangeValue $GF_Focus 0
    ChangeValue 12 1
    Set $GF_Focus = 12
 End
End

# SloppyFocus
Widget 13
Property
    Position 15 130
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                           }
Main
Case message of
SingleClic :
 Begin
    ChangeValue $GF_Focus 0
    ChangeValue 13 1
    Set $GF_Focus = 13
 End
End


# Focus Options
Widget 14
Property
    Size 275 15
    Position 310 50
    Type ItemDraw
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# ClickToFocusPassesClick/ClickToFocusDoesntPassClick
Widget 15
Property
    Position 310 80
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                           }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# ClickToFocusRaises/ClickToFocusRaisesOff & 
# MouseFocusClickRaises/MouseFocusClickDoesntRaise
Widget 16
Property
    Position 310 105
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                           }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# ColormapFocus	FollowsMouse  / FollowsFocus
Widget 17
Property
    Position 310 130
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                           }
Main
 Case message of
  SingleClic :
  Begin
  End
End

#---------------------------
# Placement of widows:
Widget 18
Property
    Size 580 15
    Position 15 165
    Type ItemDraw
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# SmartPlacement + RandomPlacement + CleverPlacementOff
Widget 19
Property
    Position 30 190
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                                                               }
Main
Case message of
SingleClic :
 Begin
    ChangeValue $GF_Placement 0
    ChangeValue 19 1
    Set $GF_Placement = 19
 End
End

# SmartPlacement + ActivePlacement + CleverPlacementOff
Widget 20
Property
    Position 30 215
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                                                               }
Main
Case message of
SingleClic :
 Begin
    ChangeValue $GF_Placement 0
    ChangeValue 20 1
    Set $GF_Placement = 20
 End
End


# SmartPlacement + RandomPlacement + CleverPlacement
Widget 21
Property
    Position 30 240
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                                                               }
Main
Case message of
SingleClic :
 Begin
    ChangeValue $GF_Placement 0
    ChangeValue 21 1
    Set $GF_Placement = 21
 End
End


# DumpPlacement + ActivePlacement + CleverPlacementOff
Widget 22
Property
    Position 30 265
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                                                               }
Main
Case message of
SingleClic :
 Begin
    ChangeValue $GF_Placement 0
    ChangeValue 22 1
    Set $GF_Placement = 22
 End
End


# DumpPlacement + RandomPlacement + CleverPlacementOff
Widget 23
Property
    Position 30 290
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                                                               }
Main
Case message of
SingleClic :
 Begin
    ChangeValue $GF_Placement 0
    ChangeValue 23 1
    Set $GF_Placement = 23
 End
End


# "Options" for Placement of widows:
Widget 24
Property
    Size 580 15
    Position 15 320
    Type ItemDraw
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# GrabFocus/GrabFocusOff
Widget 25
Property
    Position 30 345
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                                                               }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# UsePPosition/NoPPosition
Widget 26
Property
    Position 30 370
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                                                               }
Main
 Case message of
  SingleClic :
  Begin
  End
End

#-----------------------------------------------------------------------------
#
# Move and Resize
#
#-----------------------------------------------------------------------------

# Opaque Title:
Widget 30
Property
    Size 580 15
    Position 15 50
    Type ItemDraw
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# Move Opaque/OutLine 
Widget 31
Property
    Position 20 75
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden   
    Title {                        }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# ResizeOpaque
Widget 32
Property
    Position 170 75
    Type RadioButton
    Font fixed
    Flags NoReliefString Hidden   
    Title {                    }
Main
Case message of
SingleClic :
 Begin
    ChangeValue $GF_ResizeOutLine 0
    ChangeValue 32 1
    Set $GF_ResizeOutLine = 32    
 End
End

# ResizeOutline
Widget 33
Property
    Position 310 75
    Type RadioButton
    Font fixed
    Flags NoReliefString Hidden   
    Title {                    }
Main
Case message of
SingleClic :
 Begin
    ChangeValue $GF_ResizeOutLine 0
    ChangeValue 33 1
    Set $GF_ResizeOutLine = 33            
 End
End

# Opaque move size (%)
Widget 34
Property
    Position 20 105
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                                           }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# OpaqueMoveSize 
Widget 35
Property
    Position 385 100
    Size 30 15
    Type TextField
    Font fixed
    Flags NoReliefString Hidden   
    Title {}
Main
 Case message of
  SingleClic :
  Begin
  End
End


Widget 36
Property
    Position 425 105
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden   
    Title {                    }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# Geometry windows position
Widget 37
Property
    Position 20 135
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                          }
Main
 Case message of
  SingleClic :
  Begin
  End
End

Widget 38
Property
    Position 280 135
    Type RadioButton
    Font fixed
    Flags NoReliefString Hidden   
    Title {                       }
Main
Case message of
SingleClic :
 Begin
    ChangeValue $GF_Emulate 0
    ChangeValue 38 1
    Set $GF_Emulate = 38
 End
End

Widget 39
Property
    Position 440 135
    Type RadioButton
    Font fixed
    Flags NoReliefString Hidden   
    Title {                       }
Main
Case message of
SingleClic :
 Begin
    ChangeValue $GF_Emulate 0
    ChangeValue 39 1
    Set $GF_Emulate = 39        
 End
End

# Hide Geometry windows
Widget 40
Property
    Position 20 165
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                          }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# Size
Widget 41
Property
    Position 280 165
    Type RadioButton
    Font fixed
    Flags NoReliefString Hidden   
    Title {                       }
Main
Case message of
SingleClic :
 Begin
    If $GF_HideGeoSize == 1 Then
	ChangeValue 41 0
    Set $GF_HideGeoSize = (GetValue 41)
 End
End

# Move
Widget 42
Property
    Position 440 165
    Type RadioButton
    Font fixed
    Flags NoReliefString Hidden   
    Title {                       }
Main
Case message of
 SingleClic :
 Begin
    If $GF_HideGeoMove == 1 Then
	ChangeValue 42 0
    Set $GF_HideGeoMove = (GetValue 42)
 End
End

# BugOpts FlickeringMoveWorkaround
Widget 43
Property
    Position 20 195
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                                                                       }
Main
 Case message of
  SingleClic :
  Begin
  End
End

#-------------------------
# Snap Attraction:
Widget 44
Property
    Size 580 15
    Position 15 225
    Type ItemDraw
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# distance
Widget 45
Property
    Position 65 255
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {               }
Main
Case message of
    SingleClic :
    Begin
    End
End

# distance value
Widget 46
Property
    Position 155 250
    Size 30 15
    Type TextField
    Font fixed
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# context
Widget 47
Property
    Position 260 255
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {              }
Main
Case message of
    SingleClic :
    Begin
    End
End

# context value
Widget 48
Property
    Position 350 250
    Type PopupMenu
    Font fixed
    Flags NoReliefString Hidden
    Title {                           }
Main
Case message of
    SingleClic :
    Begin
    End
End

# SnapGrid
Widget 49
Property
    Position 65 295
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {                          }
Main
Case message of
    SingleClic :
    Begin
    End
End

# SnapGrid X title
Widget 50
Property
    Position 230 295
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {X:}
Main
Case message of
    SingleClic :
    Begin
    End
End

Widget 51
Property
    Position 250 290
    Type TextField
    Font fixed
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# SnapGrid Y title
Widget 52
Property
    Position 330 295
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {Y:}
Main
Case message of
    SingleClic :
    Begin
    End
End

Widget 53
Property
    Position 350 290
    Type TextField
    Font fixed
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

#-------------------------
# XOR Color or Pixmap: 
Widget 54
Property
    Size 580 15
    Position 15 330
    Type ItemDraw
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# Color or Pixmap? Color
Widget 55
Property
    Position 90 355
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden
    Title {                               }
Main
Case message of
 SingleClic :
 Begin
    ChangeValue 55 1
    ChangeValue 56 0
    If $GF_Xor == 1 Then
    Begin
	Set $GF_Xor = 0
	Set $GF_XorPixmap = (GetTitle 58)
	ChangeTitle 58 $GF_XorValue
	ChangeTitle 57 $l_OneColor
	ChangeTitle 59 $l_StartColorSel
    End
 End
End

# Color or Pixmap? Pixmap
Widget 56
Property
    Position 310 355
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden
    Title {                                   }
Main
Case message of
 SingleClic :
 Begin
    ChangeValue 56 1
    ChangeValue 55 0
    If $GF_Xor == 0 Then
    Begin
    	Set $GF_Xor = 1
	Set $GF_XorValue = (GetTitle 58)
	ChangeTitle 58 $GF_XorPixmap
	ChangeTitle 57 $l_OnePixmap
	ChangeTitle 59 $l_StartImages
    End
 End
End

# XOR: Title
Widget 57
Property
    Position 70 390
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {                           }
Main
Case message of
    SingleClic :
    Begin
    End
End

# XOR: Value
Widget 58
Property
    Position 210 385
    Size 90 20
    Type TextField
    Font fixed
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# XOR: Browse
Widget 59
Property
    Position 340 385
    Size 90 20
    Type PushButton
    Font fixed
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
 SingleClic :
 Begin
    If $GF_Xor == 1 Then
	Set $arg={FvwmScript-IconBrowser --icon-colorset }$ViewerColorset{ --text-colorset }$TextColorset
    Else
    Begin
	Set $tmp = (GetTitle 58)
	Set $cmd = $SendMsgAndGet{"value-2-hexcolor }$tmp{"}
	Set $tmp = (GetOutput $cmd 1 -1)
	Set $arg={FvwmScript-ColorSelector --launched yes --return-type pixels --viewer-colorset } $ViewerColorset { --color }$tmp
	ChangeTitle 990 {The color selector returns good values only with a TrueColor visual (16, 24 or 32 bpp)}
    End
    Set $GF_XorBrowser = (LaunchScript $arg)
 End
End


#-----------------------------------------------------------------------------
#
# Pagination and Mouse Parameters
#
#-----------------------------------------------------------------------------

# Pagination Title:
Widget 60
Property
    Size 580 15
    Position 15 50
    Type ItemDraw
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# Horizontal Paging: title
Widget 61
Property
    Position 20 85
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden   
    Title {                              }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# Horizontal Paging: Value
Widget 62
Property
    Position 205 80
    Type PopupMenu
    Font fixed
    Flags NoReliefString Hidden   
    Title {                }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# Horizontal Paging: circular ?
Widget 63
Property
    Position 385 85
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden
    Title {                              }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# Vertical Paging: title
Widget 64
Property
    Position 20 125
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden   
    Title {                              }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# Vertical Paging: Value
Widget 65
Property
    Position 205 120
    Type PopupMenu
    Font fixed
    Flags NoReliefString Hidden   
    Title {                }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# Vertical Paging: circular ?
Widget 66
Property
    Position 385 125
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden
    Title {                              }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# Paging Delay : title
Widget 67
Property
    Position 20 165
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {                                                   }
Main
 Case message of
  SingleClic :
  Begin
  End
End


# Paging Delay: value
Widget 68
Property
    Position 330 160
    Size 60 15
    Type TextField
    Font fixed
    Flags NoReliefString Hidden
    Title {}
Main
 Case message of
  SingleClic :
  Begin
  End
End

# Paging Delay : ms
Widget 69
Property
    Position 400 165
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {    }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# Moving Edge resistance: title
Widget 70
Property
    Position 20 200
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {                                                   }
Main
 Case message of
  SingleClic :
  Begin
  End
End


# Moving Edge resistance: value
Widget 71
Property
    Position 330 195
    Size 60 15
    Type TextField
    Font fixed
    Flags NoReliefString Hidden
    Title {}
Main
 Case message of
  SingleClic :
  Begin
  End
End

# Paging Delay : pixels
Widget 72
Property
    Position 400 200
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {        }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# PanFrame: title
Widget 73
Property
    Position 20 235
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {                                                      }
Main
 Case message of
  SingleClic :
  Begin
  End
End


# PanFrame: value
Widget 74
Property
    Position 350 230
    Type PopupMenu
    Font fixed
    Flags NoReliefString Hidden
    Title {1|2}
Main
 Case message of
  SingleClic :
  Begin
  End
End

# Pame Farme : pixels
Widget 75
Property
    Position 400 235
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {        }
Main
 Case message of
  SingleClic :
  Begin
  End
End

#----------------------------------------
# Mouse Parameters

# Title:
Widget 76
Property
    Size 580 15
    Position 15 285
    Type ItemDraw
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# Double click: title
Widget 77
Property
    Position 20 325
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {                                                        }
Main
 Case message of
  SingleClic :
  Begin
  End
End


# Double Click: value
Widget 78
Property
    Position 335 320
    Size 30 15
    Type TextField
    Font fixed
    Flags NoReliefString Hidden
    Title {}
Main
 Case message of
  SingleClic :
  Begin
  End
End

# Double Click : pixels
Widget 79
Property
    Position 380 325
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {    }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# MoveThreshold: title
Widget 80
Property
    Position 20 360
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {                                                        }
Main
 Case message of
  SingleClic :
  Begin
  End
End


# MoveThreshold: value
Widget 81
Property
    Position 335 355
    Size 30 15
    Type TextField
    Font fixed
    Flags NoReliefString Hidden
    Title {}
Main
 Case message of
  SingleClic :
  Begin
  End
End

# MoveThreshold: pixels
Widget 82
Property
    Position 380 360
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {        }
Main
 Case message of
  SingleClic :
  Begin
  End
End

#-----------------------------------------------------------------------------
#
# Transient windows
#
#-----------------------------------------------------------------------------

# Transient Title:
Widget 90
Property
    Size 580 15
    Position 15 50
    Type ItemDraw
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# NakedTransient/DecorateTransient
Widget 91
Property
    Position 30 80
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                                                               }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# DontRaiseTransient/RaiseTransient
Widget 92
Property
    Position 30 105
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                                                                         }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# DontLowerTransient/LowerTransient
Widget 93
Property
    Position 30 130
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                                                                         }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# DontStackTransientParent/StackTransientParent
Widget 94
Property
    Position 30 155
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                                                                       }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# GrabFocusTransient/GrabFocusTransientOff
Widget 95
Property
    Position 30 180
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                                                                       }
Main
 Case message of
  SingleClic :
  Begin
  End
End

#-------------------------
# Animations Speed:
Widget 96
Property
    Size 580 15
    Position 15 220
    Type ItemDraw
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# ShadeSetps title
Widget 97
Property
    Position 30 255
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {                                      }
Main
Case message of
    SingleClic :
    Begin
    End
End

# ShadeSetps
Widget 98
Property
    Position 260 250
    Size 40 15
    Type TextField
    Font fixed
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# ShadeScroll/Shrinks
Widget 99
Property
    Position 30 287
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden
    Title {                                                                               }
Main
Case message of
    SingleClic :
    Begin
    End
End

# SetAnimation title
Widget 100
Property
    Position 30 320
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {                               }
Main
Case message of
    SingleClic :
    Begin
    End
End

# SetAnimation speed title
Widget 101
Property
    Position 250 320
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {                       }
Main
Case message of
    SingleClic :
    Begin
    End
End

# SetAnimation speed value
Widget 102
Property
    Position 395 315
    Type TextField
    Font fixed
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# SetAnimation fractions-to-move-list title
Widget 103
Property
    Position 50 352
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {                                 }
Main
Case message of
    SingleClic :
    Begin
    End
End

# SetAnimation fractions-to-move-list value
Widget 104
Property
    Position 255 347
    Size 335 15
    Type TextField
    Font fixed
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# Some preconfigurated value title
Widget 105
Property
    Position 50 382
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {               }
Main
Case message of
    SingleClic :
    Begin
    End
End

# Some preconfigurated value: value
Widget 106
Property
    Position 255 379
    Type PopupMenu
    Font fixed
    Flags NoReliefString Hidden
    Title {                       }
Main
Case message of
    SingleClic :
    Begin
    End
End

#-----------------------------------------------------------------------------
#
# Hints, Busy Cursor
#
#-----------------------------------------------------------------------------

# Hints Title:
Widget 110
Property
    Size 580 15
    Position 15 50
    Type ItemDraw
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# Mwm Decor
Widget 111
Property
    Position 35 80
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden
    Title {                                      }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# OLD
Widget 112
Property
    Position 35 105
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                      }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# HintsOverRead
Widget 113
Property
    Position 35 130
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                      }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# Mwm Functions
Widget 114
Property
    Position 310 80
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                      }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# GNOME
Widget 115
Property
    Position 310 105
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                      }
Main
 Case message of
  SingleClic :
  Begin
  End
End

# ModalityIsEvil
Widget 116
Property
    Position 310 130
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {                                      }
Main
 Case message of
  SingleClic :
  Begin
  End
End

#---------------------
# Busy cursor Title:
Widget 117
Property
    Size 580 15
    Position 15 170
    Type ItemDraw
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# Read
Widget 118
Property
    Position 55 200
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden
    Title {Read}
Main
 Case message of
  SingleClic :
  Begin
  End
End

# Recapture
Widget 119
Property
    Position 170 200
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {Recapture}
Main
 Case message of
  SingleClic :
  Begin
  End
End

# Wait
Widget 120
Property
    Position 285 200
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {Wait}
Main
 Case message of
  SingleClic :
  Begin
  End
End

# ModuleSynchrnous
Widget 121
Property
    Position 400 200
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden   
    Title {ModuleSynchornous}
Main
 Case message of
  SingleClic :
  Begin
  End
End

#--------------------------------
# Avanced (default are good!)
Widget 122
Property
    Size 580 15
    Position 15 240
    Type ItemDraw
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# CloroLimit: title
Widget 123
Property
    Position 35 275
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {                                               }
Main
Case message of
    SingleClic :
    Begin
    End
End

# CloroLimit: value
Widget 124
Property
    Position 320 270
    Type PopupMenu
    Font fixed
    Flags NoReliefString Hidden
    Title {Default|2|9|19|29|39|49|61|No Limit}
Main
Case message of
    SingleClic :
    Begin
    End
End

# MixedVisualWorkArround
Widget 125
Property
    Position 35 310
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden
    Title { MixedVisualWorkArround}
Main
 Case message of
  SingleClic :
  Begin
  End
End

# RaiseOverNativeWindows
Widget 126
Property
    Position 35 345
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden
    Title { RaiseOverNativeWindows}
Main
 Case message of
  SingleClic :
  Begin
  End
End

# SaveUnder
Widget 129
Property
    Position 280 310
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden
    Title { SaveUnder}
Main
 Case message of
  SingleClic :
  Begin
  End
End

# BackingStore
Widget 130
Property
    Position 280 345
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden
    Title { BackingStore}
Main
 Case message of
  SingleClic :
  Begin
  End
End


# ModuleTimeOut
Widget 127
Property
    Position 35 380
    Type ItemDraw
    Font fixed
    Flags NoReliefString Hidden
    Title {                                                            }
Main
Case message of
    SingleClic :
    Begin
    End
End

# ModuleTimeOut: value
Widget 128
Property
    Position 400 375
    Type PopupMenu
    Font fixed
    Flags NoReliefString Hidden
    Title {2 sec|5 sec|7 sec|10 sec|15 sec |30 sec|45 sec|60 sec|120 sec}
Main
Case message of
    SingleClic :
    Begin
    End
End

#-----------------------------------------------------------------------------
#
# Preference
#
#-----------------------------------------------------------------------------

#theme and files title
Widget 950
Property
    Size 580 15
    Position 15 50
    Type ItemDraw
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# some explaination
Widget 951
Property
    Position 15 80
    Type ItemDraw
    Flags NoReliefString Hidden
    Font fixed
    Title {                                                                                             }
Main
Case message of
    SingleClic :
    Begin
    End
End

# load an other config: title
Widget 952
Property
    Position 35 115
    Type ItemDraw
    Flags NoReliefString Hidden
    Font fixed
    Title {                                    }
Main
Case message of
    SingleClic :
    Begin
    End
End

# load an other config: choices
Widget 953
Property
    Position 265 110
    Type PopupMenu
    Flags NoReliefString Hidden
    Title {                          }
Main
Case message of
    SingleClic :
    Begin
    End
End

# reserved!
Widget 954
Property
    Position 608 110
    Size 1 1
    Type ItemDraw
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# load an other config: apply
Widget 955
Property
    Position 430 110
    Size 80 20
    Type PushButton
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
 SingleClic :
 Begin
    Set $ThemeToLoad = (GetValue 953)
    Set $GF_UpdateConfig = 1
    Set $LoadFromPreference = 1
    Set $CmdType = {}
 End
End

# where we save: title
Widget 956
Property
    Position 35 155
    Type ItemDraw
    Flags NoReliefString Hidden
    Font fixed
    Title {                         }
Main
Case message of
    SingleClic :
    Begin
    End
End

# where we save: theme
Widget 957
Property
    Position 150 155
    Type ItemDraw
    Flags NoReliefString Hidden
    Font fixed
    Title {                        }
Main
Case message of
    SingleClic :
    Begin
    End
End

# change where we save: title
Widget 958
Property
    Position 50 185
    Type ItemDraw
    Flags NoReliefString Hidden
    Font fixed
    Title {                                }
Main
Case message of
    SingleClic :
    Begin
    End
End

# change where we save: choice
Widget 959
Property
    Position 265 180
    Type PopupMenu
    Flags NoReliefString Hidden
    Title {                            }
Main
Case message of
    SingleClic :
    Begin
    End
End

# change where we save: apply
Widget 960
Property
    Position 430 180
    Size 80 20
    Type PushButton
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
 SingleClic :
 Begin
    Set $tmp = (GetValue 959)
    Set $cmd = $SendMsgAndGet{"set-save-file }$Component{ }$tmp{"}
    Set $tmp = (GetOutput $cmd 1 -1)
    ChangeTitle 957 $tmp
 End
End

# Preference
Widget 961
Property
    Size 580 15
    Position 15 235
    Type ItemDraw
    Flags NoReliefString Hidden
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# 
Widget 962
Property
    Position 30 270
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden
    Title {                                                                                          }
Main
Case message of
 SingleClic :
 Begin
    Set $GF_TryIsGlobal = (GetValue 962)
 End
End

Widget 963
Property
    Position 30 305
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden
    Title {                                                                                          }
Main
Case message of
 SingleClic :
 Begin
    Set $GF_DefaultIsGlobal = (GetValue 963)
 End
End

Widget 964
Property
    Position 30 340
    Type CheckBox
    Font fixed
    Flags NoReliefString Hidden
    Title {                                                                                          }
Main
Case message of
 SingleClic :
 Begin
    Set $GF_SaveIsGlobal = (GetValue 964)
 End
End

##############################################################################
#
# 
#
##############################################################################

#-----------------------------------------------------------------------------
#
# Message, Apply, quit, ...
#
#-----------------------------------------------------------------------------

# Message
Widget 990
Property
    Flags NoReliefString
    Position 20 417
    Size 560 20
    Type ItemDraw
    Title {}
Main
Case message of
    SingleClic :
    Begin
    End
End

# Save
Widget 991
Property
    Flags NoReliefString
    Position 30 450
    Size 85 20
    Type PushButton
    Title {}
Main
Case message of
 SingleClic :
 Begin
    #Execute 1 : just below
    SendSignal 991 1
 End
 1 :
 Begin
    If $ConfigTool == {Preference} Then
    Begin
	Set $msg = {Will be implemented later}
	ChangeTitle 990 $msg
    End
    Else
    Begin
	Set $GF_BuildConfig = 1
	If $GF_SaveIsGlobal == 1 Then
	    Set $GF_BuildAllConfig = 1
	Else
	    Set $GF_BuildAllConfig = 0
	Set $DoApplyCmd = 1
	Set $CmdType = {Save}
    End
 End
End

# Try
Widget 992
Property
    Flags NoReliefString
    Position 145 450
    Size 85 20
    Type PushButton
    Title {}
Main
Case message of
 SingleClic :
 Begin
    #Execute 1 : just below
    SendSignal 992 1
 End
 1 :
 Begin
    If $ConfigTool <> {Preference} Then
    Begin
	Set $GF_BuildConfig = 1
	If $GF_TryIsGlobal == 1 Then
	    Set $GF_BuildAllConfig = 1
	Else
	    Set $GF_BuildAllConfig = 0
	Set $DoApplyCmd = 1
	Set $CmdType = {Try}
    End
    Else
    Begin
	ChangeTitle 990 $l_NoEffectHere
    End
 End
End

# Load Default
Widget 993
Property
    Flags NoReliefString
    Position 260 450
    Size 85 20
    Type PushButton
    Title {}
Main
Case message of
 SingleClic :
 Begin
    #Execute 1 : just below
    SendSignal 993 1
 End
 1 :
 Begin
    If $ConfigTool <> {Preference} Then
    Begin
	Set $GF_UpdateConfig = 1
	Set $ThemeToLoad = {default}
	Set $LoadFromPreference = 0
    End
    Else
    Begin
	ChangeTitle 990 $l_NoEffectHere
    End
 End
End

# Help
Widget 994
Property
    Flags NoReliefString
    Position 375 450
    Size 85 20
    Type PushButton
    Title {}
Main
Case message of
 SingleClic :
 Begin
    #Execute 1 : just below
    SendSignal 991 1
 End
 1 :
 Begin
    Set $arg={FvwmScript-Help --text-colorset }$TextColorset{ --message "                    Documentation in progress" --title "Help for the Main Config}
    Set $dummy = (LaunchScript $arg)
 End
End

# Quit
Widget 995
Property
    Flags NoReliefString
    Position 490 450
    Size 85 20
    Type PushButton
    Title {Quit}
Main
Case message of
 SingleClic :
 Begin
 #Execute 1 : just below
    SendSignal 995 1
 End
 1 :
 Begin
   Set $cmd = $SendMsg{"exit"}
   Do {Exec }$cmd
   Quit
 End
End
